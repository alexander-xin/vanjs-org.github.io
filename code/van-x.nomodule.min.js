{let e,t,r,{fromEntries:o,entries:n,keys:l}=Object,{get:f,set:i,deleteProperty:c,ownKeys:a}=Reflect,{state:s,derive:y,add:b}=van,m=1e3,d=Symbol(),u=Symbol(),w=Symbol(),j=Symbol(),O=Symbol(),S=Symbol(),g=e=>(e[w]=1,e),p=e=>{if(e?.[w]){let t=s();return y(()=>{let r=e();t.rawVal instanceof Object&&r instanceof Object?k(t.rawVal,r):t.val=v(r)}),t}return s(v(e))},v=e=>e instanceof Object&&!e[u]?new Proxy((e[d]=e,e[u]=o(n(e).map(([e,t])=>[e,p(t)])),e[j]=[],e[O]=s(1),e),{get:(e,t,r)=>e[u].hasOwnProperty(t)?e[u][t].val:("length"===t&&e[O].val,f(e,t,r)),set(e,t,r,o){let n=e[u];if(n.hasOwnProperty(t))return n[t].val=v(r),1;let l=t in e,f=l&&"length"===t&&r!==e.length;return i(e,t,r)?(l?f&&++e[O].val:i(n,t,p(r))&&(++e[O].val,F(o,t,n[t])),1):void 0},deleteProperty:(e,t)=>(c(e[u],t)&&N(e,t),c(e,t)&&++e[O].val),ownKeys:e=>(e[O].val,a(e))}):e,A=e=>e[u],P=e=>e[u]?new Proxy(e[u],{get:(e,t)=>P(e[t].rawVal)}):e,h=e=>e[j]=e[j].filter(e=>e.t.isConnected),D=(e,t,r,o,{t:n,f:f})=>{let i=Array.isArray(e);if(b(n,()=>n[S][t]=f(r,()=>delete e[t],i?Number(t):t)),i&&!o&&t!=e.length-1){let r=Number(t);n.insertBefore(n.lastChild,n[S][l(e).find(e=>Number(e)>r)])}},F=(e,o,n)=>h(e).forEach(D.bind(t,e,o,n,r)),N=(e,t)=>{for(let r of h(e)){let e=r.t[S];e[t]?.remove(),delete e[t]}},_=r=>(e??(setTimeout(()=>(e.forEach(h),e=t),m),e=new Set)).add(r),x=(e,t,r)=>{let o={t:e instanceof Function?e():e,f:r};o.t[S]={},t[j].push(o),_(t);for(let[e,r]of n(t[u]))D(t,e,r,1,o);return o.t},K=(e,t)=>{for(let[r,o]of n(t)){let t=e[r];t instanceof Object&&o instanceof Object?K(t,o):e[r]=o}for(let r in e)t.hasOwnProperty(r)||delete e[r];let r=l(t),o=Array.isArray(e);if(o||l(e).some((e,t)=>e!==r[t])){if(o)e.length=t.length;else{++e[O].val;let t=e[d],o={...t};for(let e of r)delete t[e];for(let e of r)t[e]=o[e]}for(let{t:t}of h(e)){let{firstChild:e,[S]:o}=t;for(let n of r)e===o[n]?e=e.nextSibling:t.insertBefore(o[n],e)}}return e},k=(e,l)=>{r=1;try{return K(e,l instanceof Function?Array.isArray(e)?l(e.filter(e=>1)):o(l(n(e))):l)}finally{r=t}},C=e=>Array.isArray(e)?e.filter(e=>1).map(C):e instanceof Object?o(n(e).map(([e,t])=>[e,C(t)])):e;window.vanX={calc:g,reactive:v,stateFields:A,raw:P,list:x,replace:k,compact:C}}